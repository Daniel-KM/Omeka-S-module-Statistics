CREATE TABLE IF NOT EXISTS `stat` (
    `id` int NOT NULL AUTO_INCREMENT,
    `type` varchar(8) COLLATE utf8_unicode_ci NOT NULL,
    `url` LONGTEXT COLLATE utf8_unicode_ci NOT NULL,
    `entity_name` varchar(190) COLLATE utf8_unicode_ci NOT NULL DEFAULT '',
    `entity_id` int NOT NULL DEFAULT 0,
    `hits` int NOT NULL DEFAULT 0,
    `hits_anonymous` int NOT NULL DEFAULT 0,
    `hits_identified` int NOT NULL DEFAULT 0,
    `created` timestamp NOT NULL,
    `modified` timestamp ON UPDATE CURRENT_TIMESTAMP,
    PRIMARY KEY (`id`),
    INDEX `type` (`type`),
    INDEX `url` (`url`),
    INDEX `entity_name` (`entity_name`),
    INDEX `entity_name_entity_id` (`entity_name`, `entity_id`),
    INDEX `hits` (`hits`),
    INDEX `hits_anonymous` (`hits_anonymous`),
    INDEX `hits_identified` (`hits_identified`),
    INDEX `modified` (`modified`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8 COLLATE=utf8_unicode_ci;
CREATE TABLE IF NOT EXISTS `hit` (
    `id` int NOT NULL AUTO_INCREMENT,
    `url` LONGTEXT COLLATE utf8_unicode_ci NOT NULL,
    `entity_name` varchar(190) COLLATE utf8_unicode_ci NOT NULL DEFAULT '',
    `entity_id` int NOT NULL DEFAULT 0,
    `user_id` int NOT NULL DEFAULT 0,
    `ip` varchar(45) COLLATE utf8_unicode_ci NOT NULL DEFAULT '',
    `referrer` varchar(1024) COLLATE utf8_unicode_ci NOT NULL DEFAULT '',
    `query` varchar(1024) COLLATE utf8_unicode_ci NOT NULL DEFAULT '',
    `user_agent` varchar(1024) COLLATE utf8_unicode_ci NOT NULL DEFAULT '',
    `accept_language` varchar(190) COLLATE utf8_unicode_ci NOT NULL DEFAULT '',
    `created` timestamp NOT NULL,
    PRIMARY KEY (`id`),
    INDEX `url` (`url`),
    INDEX `entity_name` (`entity_name`),
    INDEX `entity_name_entity_id` (`entity_name`, `entity_id`),
    INDEX `user_id` (`user_id`),
    INDEX `ip` (`ip`),
    INDEX `referrer` (`referrer`),
    INDEX `query` (`query`),
    INDEX `user_agent` (`user_agent`),
    INDEX `accept_language` (`accept_language`),
    INDEX `created` (`created`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8 COLLATE=utf8_unicode_ci;
